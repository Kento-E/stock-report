# GitHub Copilot Instructions

このリポジトリで GitHub Copilot を使用する際の指示事項です。

## はじめに

このリポジトリは、株式銘柄の動向をAIで自動分析し、レポートを生成・配信するPythonシステムです。

詳細な情報は以下のドキュメントを参照してください：

- **システム概要・技術スタック**: README.md
- **要件定義と仕様書**: specs/requirements-index.md（エントリーポイント）

## 言語設定

- **すべての出力（Pull Request のタイトル、説明、コメント、コミットメッセージ、コード内のコメント、ドキュメント等）は日本語で記述してください。**
- Pull Request の作成時は、タイトルと説明を必ず日本語で記述してください。
- **コミットメッセージは日本語で記述してください。** 例: 「機能: 実行スケジュールを週2回に変更」「修正: データ収集頻度の記載を削除」
- コードレビュー時のコメントも日本語で記述してください。
- Issue への返信やコメントも日本語で記述してください。

## PR説明文の更新

- **PR説明文を更新する際は、既存のHTMLコメントを必ず保持すること**
  - 特に `<!-- for GitHub Copilot review rule -->` で囲まれた部分は絶対に削除しないこと
  - PRテンプレートの区切り線（`---`）以降の内容は常に保持すること
- **`report_progress` ツールを使用する際の注意**
  - PRテンプレートのHTMLコメントを含めた完全な説明文を渡すこと
  - 説明文の最後に必ず以下の形式でテンプレートのコメントを含めること:

```markdown
## 変更内容

<!-- ここにPRの説明を記載してください -->
（あなたの説明文）
<!-- 以下の区切り線とコメントは削除・変更しないでください -->

---

<!-- for GitHub Copilot review rule -->
<!--
必ず、日本語でレビューしてください。レビュー結果を日本語で記載してください。
PRのタイトルを修正すべきであれば指摘してください。
-->
<!-- for GitHub Copilot review rule -->
```

## コーディング規約

- 本プロジェクトは日本語コメントを推奨します。
- 変数名や関数名は英語でも構いませんが、説明やドキュメントは日本語で記述してください。
- 既存のコードスタイルに従ってください。
- Markdown、Python等の詳細なコーディングルールは `.github/instructions/coding.instructions.md` を参照してください。

## ドキュメント・要件定義書の反映

ドキュメント作成・更新の詳細なガイドラインは `.github/instructions/documentation.instructions.md` を参照してください。

### 基本原則

- ソースコードを修正した場合は、該当する仕様書にも必ず要件を反映してください。
- 要件定義書は機能別に分割されています。該当する仕様書を更新してください。
- DRY原則（Don't Repeat Yourself）を守り、情報の重複を避けてください。

### 仕様書の選択

変更内容に応じて、適切な仕様書を更新してください：

- **システム構成・モジュール変更**: specs/system-architecture.md
- **データ収集・AI分析機能**: specs/data-collection-analysis.md
- **レポート生成・メール配信**: specs/report-email.md
- **自動化・テスト・CI/CD**: specs/automation-cicd.md
- **銘柄リスト・投資志向性設定**: specs/data-management.md

## GitHub Copilot Premium の効率的な利用

GitHub Copilot Premium の消費を節約しつつ、コード品質を維持するため、以下の方針に従ってください。

### テスト戦略

テスト自動化の詳細については `.github/instructions/testing.instructions.md` および `docs/TEST.md` を参照してください。

重要なポイント：

- Pull Request作成時に自動的にテストが実行されるため、手動でのテスト実施は不要
- 新規機能追加時は、既存のテストパターンに従って必要最小限のテストを追加
- ローカルでのテスト実行は、デバッグ時など必要な場合のみ実施

### ドキュメント方針

- **仕様書の更新は必須**: システムの機能や構成に変更があった場合、該当する仕様書への反映は必須です。
- **実用性の確認**: 新規ドキュメントの作成は、明確な実用性がある場合のみ行ってください。例えば、新しい機能の使用方法、複雑な設定手順、トラブルシューティングガイドなど。
- **既存ドキュメントの活用**: 以下の既存ドキュメントを優先的に更新してください。新規ファイルの作成は最小限に。
  - README.md: ユーザー向け使用方法・セットアップ手順
  - docs/TEST.md: テスト実行方法
  - specs/requirements-index.md: 要件定義インデックス
  - specs/*.md: 機能別仕様書
- **サンプルやテンプレートファイル**: 実際に使用されないサンプルファイルやテンプレートファイルの作成は避けてください。

### 作業効率化

- **最小限の変更**: 問題を解決するために必要最小限のコード変更を心がけてください。
- **自動化の活用**: テスト、ビルド、デプロイなどは既存のGitHub Actionsワークフローを活用してください。
- **重複作業の回避**: 同じような処理が既に実装されている場合、既存のコードを再利用してください。

## 追加の指示ファイル

プロジェクトには以下の追加指示ファイルがあります。適切な状況で参照してください：

- `.github/instructions/coding.instructions.md`: Markdown Lintルール、Pythonコードのエラーハンドリング、コード品質ルール
- `.github/instructions/documentation.instructions.md`: ドキュメントの責任分掌、DRY原則、適切な配置ルール
- `.github/instructions/testing.instructions.md`: GitHub Actionsによる自動テスト、エラー確認、自動マージ機能の手順

## VS Code カスタムチャット参加者

VS Code で GitHub Copilot を使用する際、カスタムチャット参加者を利用できます。

- **@kansai**: 関西弁で応答するフレンドリーなプログラミングアシスタント

詳細は `copilot-chat-participants.md` を参照してください。

## 参考リンク

- README.md: ユーザー向け使用方法・セットアップ手順
- data/README.md: 銘柄リスト・投資志向性設定の編集ガイド
- docs/TEST.md: ユニットテストの実行方法
- specs/requirements-index.md: 要件定義と機能別仕様書のインデックス
