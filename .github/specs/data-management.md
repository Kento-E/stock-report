# データ管理機能仕様書

> **Note**: このファイルは銘柄リストと投資志向性設定の管理仕様を定義します。

## 銘柄リスト管理

### ファイル形式

- 銘柄リストは `data/stocks.yaml` ファイル（YAML形式）で管理。
- Git で変更履歴を管理できるため、いつ・誰が・どの銘柄を追加/削除したか追跡可能。

### データ構造

構造化されたデータ形式で、銘柄ごとに以下の情報を管理可能：

#### 必須フィールド

- **`symbol`**: 銘柄コード（文字列または数値）
  - 文字列形式：'7203.T'、'AAPL'など
  - 数値形式：7203、6758など（4桁数値は自動的に`.T`サフィックスが追加され日本株として扱われる）

#### 任意フィールド

- **`name`**: 企業名。レポートの見出しに使用される。未設定の場合は銘柄コードが使用される。
- **`added`**: 追加日（YYYY-MM-DD形式推奨）
- **`note`**: メモ・注記（自由記述）
- **`quantity`**: 保有数
  - プラスの数値：保有中
  - マイナスの数値：空売り中
  - 未設定または0：購入検討中
- **`acquisition_price`**: 取得単価（購入価格または空売り価格、正の数値）
- **`currency`**: 通貨単位（円、ドル、ユーロ、ポンドなど）
  - 未設定の場合は銘柄シンボルから自動判定（4桁数値は円と判定）
- **`account_type`**: 口座種別（'特定'/'NISA'/'旧NISA'、デフォルトは'特定'）
  - **特定**: 譲渡益に20.315%課税
  - **NISA**: 非課税
  - **旧NISA**: 非課税
- **`considering_action`**: 検討中のアクション（'buy'/'short_sell'）
  - `quantity`が未設定または0の場合に有効

### 編集方法

#### GitHub Web インターフェース

1. GitHub上で `data/stocks.yaml` ファイルを開く
2. 編集ボタン（鉛筆アイコン）をクリック
3. 銘柄を追加・削除・編集
4. 変更をコミット

スマートフォンのブラウザからも同様の手順で編集できます。

#### コメント機能

- YAMLのコメント機能（`#` で始まる行）を使用可能。
- コメントは自動フォーマット時にも保持される。

### 拡張性

- 将来的に銘柄ごとの追加設定（アラート閾値、分析頻度など）を柔軟に追加可能。

**詳細な編集方法は <a>README.md</a> を参照してください。**

## 投資志向性設定

### ファイル形式

- ユーザーの投資に対する志向性を独立した設定ファイル（`data/investment_preferences.yaml`）で管理。
- Git で変更履歴を管理。

### 設定項目

#### 投資スタイル（`investment_style`）

以下から1つ選択：

- **growth**: 成長投資（成長が期待できる企業に投資）
- **value**: バリュー投資（割安な企業に投資）
- **income**: インカムゲイン投資（配当や利息収入を重視）
- **balanced**: バランス投資（成長とバリューのバランス）
- **speculative**: 投機的投資（短期的な値動きを狙う）

#### リスク許容度（`risk_tolerance`）

以下から1つ選択：

- **low**: 低リスク（安定性を重視）
- **medium**: 中リスク（バランス重視）
- **high**: 高リスク（高リターンを狙う）

#### 投資期間（`investment_horizon`）

以下から1つ選択：

- **short**: 短期（数日〜数ヶ月）
- **medium**: 中期（数ヶ月〜1年程度）
- **long**: 長期（1年以上）

#### 売買頻度（`trading_frequency`）

以下から1つ選択：

- **high**: 頻繁（頻繁に売買）
- **medium**: 適度（必要に応じて売買）
- **low**: 少ない（長期保有が中心）

#### 重視する指標（`focus_areas`）

以下から複数選択可能（リスト形式）：

- **technical**: テクニカル分析（チャート分析、価格動向）
- **fundamental**: ファンダメンタル分析（企業の業績、財務状況）
- **news**: ニュース（最新のニュースやイベント）
- **dividend**: 配当（配当利回り、配当性向）
- **momentum**: モメンタム（価格の勢い、トレンド）

#### カスタムメッセージ（`custom_message`）

- 追加の要望を自由記述（任意）
- AI分析時のプロンプトに含まれる

### デフォルト設定

ファイルが存在しない場合は以下のデフォルト値を使用：

- 投資スタイル: balanced（バランス投資）
- リスク許容度: medium（中リスク）
- 投資期間: medium（中期）
- 売買頻度: medium（適度）
- 重視する指標: [fundamental, news]（ファンダメンタル分析とニュース）

### 設定の反映

- 設定内容はAI分析時のプロンプトに含まれ、個人の投資方針に合わせた分析を提供。
- 設定変更は次回の分析実行時から自動的に反映される。

### テンプレート

- テンプレートと選択肢を明示し、初見のユーザーでも迷わずに設定可能。
- バリデーション機能により、設定ファイルの形式を自動検証。

**詳細な設定方法は <a>README.md</a> と <a>data/README.md</a> を参照してください。**

## データバリデーション

### stocks.yaml バリデーション

詳細は <a>automation-cicd.md</a> の「バリデーション自動実行」セクションを参照してください。

### investment_preferences.yaml バリデーション

詳細は <a>automation-cicd.md</a> の「バリデーション自動実行」セクションを参照してください。

## データフォーマット

### YAML自動フォーマット

詳細は <a>automation-cicd.md</a> の「YAML自動フォーマット」セクションを参照してください。
